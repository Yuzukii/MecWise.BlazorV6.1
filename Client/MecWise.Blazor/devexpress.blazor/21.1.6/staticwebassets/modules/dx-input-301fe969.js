import{B as e}from"./dom-a06f5987.js";import{d as t,r as s}from"./disposable-35c3c450.js";import{u as i,o as n,e as o,f as a}from"./dom-utils-69ea39c0.js";class r{constructor(e,t){this.preloader=e,this.parent=t,this._initialPaddingRight=0,this._initialPaddingLeft=0,this._contentWidth=0,this._internalWidthChanging=!1,this._unsubscriber=()=>!1,this._onHide=new Array,this.preloaderElement=e,this._preloaderWidth=e.offsetWidth,this.parentElement=t}static get(e){return r.preloaderMap.get(e)}static create(e,t){let s=r.get(e);return s||(s=new r(e,t),r.preloaderMap.set(e,s)),s}static remove(e){const t=r.preloaderMap.get(e);t&&(t.hide(),r.preloaderMap.delete(e))}display(e){this.init(e),this.preloaderElement.style.top=(this.parentElement.offsetHeight-this.preloaderElement.offsetHeight)/2+"px",this.calculateHorizontalPosition(this.parentElement.clientWidth-this._initialPaddingLeft-this._initialPaddingRight),this._internalWidthChanging=!0,this._unsubscriber=this.subscribeOnParentWidthChange(),this.preloaderElement.classList.remove("dxbs-preloader-initial")}hide(){this.preloaderElement.onanimationend=()=>{this.preloaderElement.style.display="none",i(this._unsubscriber),this.parentElement.style.paddingRight=this._initialPaddingRight+"px",this._onHide.forEach((e=>{e()})),this._onHide=[]},this.preloaderElement.classList.add("dxbs-preloader-success")}registerOnHideAction(e){this._onHide.push(e)}changeInitialPaddingRight(e){this._initialPaddingRight=e}init(e){this._contentWidth=e;const t=getComputedStyle(this.parentElement);this._initialPaddingRight=parseFloat(t.paddingRight),this._initialPaddingLeft=parseFloat(t.paddingLeft)}subscribeOnParentWidthChange(){return n(this.parentElement,(e=>{this._internalWidthChanging?this._internalWidthChanging=!1:this.calculateHorizontalPosition(e)}))}calculateHorizontalPosition(e){const t=parseFloat(this.parentElement.style.paddingRight);if(0===e||t===this._initialPaddingRight&&e-this._preloaderWidth<0)return this.preloaderElement.style.visibility="hidden",void(t!==this._initialPaddingRight&&(this._internalWidthChanging=!0,this.parentElement.style.paddingRight=this._initialPaddingRight+"px"));if(this.preloaderElement.style.visibility="visible",e<this._preloaderWidth+this._contentWidth)this.preloaderElement.style.left="auto",this.preloaderElement.style.right=this._initialPaddingRight+"px",t!==this._initialPaddingRight+this._preloaderWidth&&(this.parentElement.style.paddingRight=this._initialPaddingRight+this._preloaderWidth+"px",this._internalWidthChanging=!0);else{this.preloaderElement.style.left="calc("+(this._contentWidth+this._initialPaddingLeft)+"px + "+(0===this._contentWidth?"0":"0.5")+"em)",t!==this._initialPaddingRight&&(this._internalWidthChanging=!0,this.parentElement.style.paddingRight=this._initialPaddingRight+"px")}}}let l;r.preloaderMap=new Map;class d{constructor(){this.init_new_manager=window.Module.mono_bind_static_method("[DevExpress.Blazor.WebAssembly.Masks] MaskWrapper.MasksCollection:GetNewManager"),this.keyPress=window.Module.mono_bind_static_method("[DevExpress.Blazor.WebAssembly.Masks] MaskWrapper.MasksCollection:KeyPress"),this.clear=window.Module.mono_bind_static_method("[DevExpress.Blazor.WebAssembly.Masks] MaskWrapper.MasksCollection:Clear"),this.paste=window.Module.mono_bind_static_method("[DevExpress.Blazor.WebAssembly.Masks] MaskWrapper.MasksCollection:Paste"),this.getValue=window.Module.mono_bind_static_method("[DevExpress.Blazor.WebAssembly.Masks] MaskWrapper.MasksCollection:GetValue"),this.setValue=window.Module.mono_bind_static_method("[DevExpress.Blazor.WebAssembly.Masks] MaskWrapper.MasksCollection:SetValue"),this.setSelection=window.Module.mono_bind_static_method("[DevExpress.Blazor.WebAssembly.Masks] MaskWrapper.MasksCollection:SetSelection"),this.disposeMaskManager=window.Module.mono_bind_static_method("[DevExpress.Blazor.WebAssembly.Masks] MaskWrapper.MasksCollection:DisposeMaskManager"),this.updateProperties=window.Module.mono_bind_static_method("[DevExpress.Blazor.WebAssembly.Masks] MaskWrapper.MasksCollection:UpdateProperties")}}class h{constructor(e){e.includes("\\")&&(e=e.split("\\").join("\\\\")),this.info=JSON.parse(e)}get selectionStart(){return this.info.selectionStart}get selectionEnd(){return this.info.selectionEnd}get value(){return this.info.value}get displayText(){return this.info.displayText}}class p{constructor(e,t){this.customWheelProcessing=!1,this.suppressFocusEvents=!1,this.focusByMouse=!1,this.inputElement=e,this.dotnetHelper=t}initializeEvents(e){const t=t=>{e.onKeyDown(t)},i=t=>{e.onKeyUp(t)},n=t=>{e.onClick(t)},o=t=>{e.onCut(t)},a=t=>{e.onPaste(t)},r=t=>{e.onDrop(t)},l=t=>{e.shouldProcessOnFocus()&&e.onFocusByTab(e.inputElement.value?e.inputElement.value.length:0),e.focusByMouse=!1},d=t=>{e.focusByMouse=!1,e.onFocusOut(t)},h=t=>{e.onWheel(t,e)},p=t=>{e.checkValidInput()&&(e.focusByMouse=!0)};this.inputElement.addEventListener("keydown",t),this.inputElement.addEventListener("keyup",i),this.inputElement.addEventListener("click",n),this.inputElement.addEventListener("cut",o),this.inputElement.addEventListener("paste",a),this.inputElement.addEventListener("drop",r),this.inputElement.addEventListener("focus",l),this.inputElement.addEventListener("focusout",d),this.inputElement.addEventListener("wheel",h,{passive:!1}),this.inputElement.addEventListener("mousedown",p),s(this.inputElement,(()=>{e.inputElement.removeEventListener("keydown",t),e.inputElement.removeEventListener("keyup",i),e.inputElement.removeEventListener("click",n),e.inputElement.removeEventListener("cut",o),e.inputElement.removeEventListener("paste",a),e.inputElement.removeEventListener("drop",r),e.inputElement.removeEventListener("focus",l),e.inputElement.removeEventListener("focusout",d),e.inputElement.removeEventListener("wheel",h),e.inputElement.removeEventListener("mousedown",p),e.disposeMaskManager()}))}disposeMaskManager(){}checkValidInsertion(e,t){return"Backspace"===e.key||"Delete"===e.key||"Home"===e.key||"Enter"===e.key||"End"===e.key||("ArrowUp"===e.key||"ArrowDown"===e.key)&&!t||"ArrowLeft"===e.key||"ArrowRight"===e.key||e.ctrlKey&&("a"===e.key||"z"===e.key)||!e.ctrlKey&&1===e.key.length}shouldProcessOnFocus(){return!this.suppressFocusEvents&&!e.MobileUI&&!this.focusByMouse&&this.checkValidInput()}checkValidInput(){return!this.inputElement.disabled&&!this.inputElement.readOnly}canHandleMouseWheel(){return this.checkValidInput()&&document.activeElement===this.inputElement&&!this.customWheelProcessing}}class u extends p{constructor(e,t,s,i){super(e,t),this.managerId=-1,this.isWheelScrolling={timer:0},this.onDispose=new Array,this.spinButtonsFocusEventsBlocked=!1,this.maskProperties=s,this.onInputMode=i,this.customWheelProcessing=s.customWheelProcessing}initializeMonoMasks(e,t){return new Promise(((s,i)=>{this.maskProperties&&this.maskProperties.editMask&&0!==this.maskProperties.maskMode?(this.inputElement.value=e,this.displayPreloader(),void 0!==l?(this.initializeInternal(t),s()):(u.maskLoadingPromise||this.loadMasks(),u.maskLoadingPromise.then((()=>{this.initializeInternal(t),s()})))):i()}))}initializeInternal(e){t(this.inputElement),this.managerId=l.init_new_manager(this.maskProperties.maskMode,this.maskProperties.editMask,this.maskProperties.placeholder,this.maskProperties.lcid,this.maskProperties.flags,this.maskProperties.valueString,this.maskProperties.valueType,e),this.initializeEvents(this);const s=a(this.inputElement,".dxbs-spin-edit");s&&this.blockSpinButtonFocusEvents(s,this),this.fadeOutPreloader(),this.inputElement.setAttribute("data-dx-client-mask-initialized","true")}blockSpinButtonFocusEvents(t,s){if(e.MobileUI||this.spinButtonsFocusEventsBlocked)return;const i=t.querySelectorAll(".dxbs-spin-btn-group button:not(.dxbs-clear-btn)");if(i&&i.length>0){const e=()=>{s.setSuppressFocusEvents(!0)},t=()=>{s.setSuppressFocusEvents(!1),s.focusByMouse=!0};i.forEach((s=>{s.addEventListener("mousedown",e),s.addEventListener("focusout",t),this.onDispose.push((()=>{s.removeEventListener("mousedown",e),s.removeEventListener("focusout",t)}))})),this.spinButtonsFocusEventsBlocked=!0}}setSuppressFocusEvents(e){this.suppressFocusEvents=e}loadMasks(){u.maskLoadingPromise||(u.maskLoadingPromise=new Promise(((e,t)=>{const s=document.createElement("script");s.src="_content/DevExpress.Blazor.Server.WebAssembly/dotnet.js",s.onload=function(){!function t(){window.MONO.mono_wasm_runtime_is_ready?(document.head.removeChild(s),l=new d,e(!0)):window.setTimeout(t,100)}()},document.head.appendChild(s)})))}displayPreloader(){const e=a(this.inputElement,".dxbs-input-group");if(!e)return;const t=e.querySelector(".dxbs-preloader-container"),s=r.create(t,this.inputElement);if(s){this.blockEvents(this.inputElement,s);let t=0;if(this.inputElement.value){const s=document.createElement("span");s.style.visibility="hidden",s.style.width="auto",s.style.position="fixed",s.innerHTML=this.inputElement.value,s.style.fontSize=getComputedStyle(this.inputElement).fontSize,e.append(s),t=s.clientWidth,s.remove()}s.display(t)}}blockEvents(e,t){function s(e){e.preventDefault(),e.stopPropagation()}const i=a(e,".dxbs-input-group");let n=[];i&&(n=i.querySelectorAll("button"),n&&n.forEach((e=>{e.addEventListener("click",s),e.addEventListener("mousedown",s),e.addEventListener("mouseup",s)}))),e.addEventListener("keydown",s),e.addEventListener("click",s),e.addEventListener("cut",s),e.addEventListener("paste",s),t.registerOnHideAction((function(){e.removeEventListener("keydown",s),e.removeEventListener("click",s),e.removeEventListener("cut",s),e.removeEventListener("paste",s),n&&n.forEach((e=>{e.removeEventListener("click",s),e.removeEventListener("mousedown",s),e.removeEventListener("mouseup",s)}))}))}fadeOutPreloader(){const e=a(this.inputElement,".dxbs-input-group");if(!e)return;const t=e.querySelector(".dxbs-preloader-container");r.remove(t)}applyMaskInfo(e,t,s=""){this.checkValidInput()&&(this.inputElement.value=s||e.displayText,t&&this.dotnetHelper&&this.dotnetHelper.invokeMethodAsync("SetValue",e.value)),this.inputElement.setAttribute("dx-mask-value",e.value),document.activeElement===this.inputElement&&this.inputElement.setSelectionRange(e.selectionStart,e.selectionEnd)}onKeyDown(t){if(e.AndroidMobilePlatform&&t.preventDefault(),!this.checkValidInsertion(t,this.maskProperties.customArrowsUpDownProcessing)||!this.checkValidInput()||e.AndroidMobilePlatform)return;t.preventDefault();const s=new h(l.keyPress(this.managerId,t.key,t.shiftKey,t.ctrlKey));this.applyMaskInfo(s,this.onInputMode||"Enter"===t.key),"ArrowLeft"!==t.key&&"ArrowRight"!==t.key&&"Home"!==t.key&&"End"!==t.key||(this.suppressFocusEvents=!0,this.inputElement.blur(),this.inputElement.focus(),this.suppressFocusEvents=!1)}onKeyUp(t){if(e.AndroidMobilePlatform){let e=t.key;229===t.keyCode&&(e=this.inputElement.value.substring(this.inputElement.selectionStart-1,this.inputElement.selectionStart));const s=new h(l.keyPress(this.managerId,e,!1,!1));this.applyMaskInfo(s,this.onInputMode||"Enter"===t.key)}else"ArrowUp"!==t.key&&"ArrowDown"!==t.key||this.dotnetHelper.invokeMethodAsync("SetValue",this.inputElement.getAttribute("dx-mask-value"))}onClick(e){if(!this.checkValidInput())return;const t=new h(l.setSelection(this.managerId,this.inputElement.selectionStart,this.inputElement.selectionEnd));this.inputElement.selectionStart===this.inputElement.selectionEnd&&this.applyMaskInfo(t,!1)}onCut(e){if(!this.checkValidInput())return;e.preventDefault(),document.execCommand("copy");const t=new h(l.clear(this.managerId,this.inputElement.selectionStart,this.inputElement.selectionEnd));this.applyMaskInfo(t,this.onInputMode)}onPaste(e){if(!this.checkValidInput())return;e.preventDefault();const t=e.clipboardData,s=null==t?void 0:t.getData("Text"),i=new h(l.paste(this.managerId,s));this.applyMaskInfo(i,this.onInputMode)}onDrop(e){e.preventDefault()}onFocusByTab(e){const t=new h(l.setSelection(this.managerId,0,e));this.applyMaskInfo(t,!1)}onFocusOut(e){if(!this.checkValidInput()||this.suppressFocusEvents)return;e.preventDefault();const t=new h(l.getValue(this.managerId));this.dotnetHelper.invokeMethodAsync("OnFocusLost_RemoteMask",t.value),this.applyMaskInfo(t,!1)}onWheel(e,t){if(!this.canHandleMouseWheel())return;e.preventDefault(),window.clearTimeout(this.isWheelScrolling.timer);const s=new h(l.keyPress(this.managerId,e.deltaY<0?"ArrowUp":"ArrowDown",!1,!1));this.applyMaskInfo(s,!1),this.isWheelScrolling.timer=setTimeout((function(){t.dotnetHelper.invokeMethodAsync("SetValue",t.inputElement.getAttribute("dx-mask-value"))}),500)}disposeMaskManager(){for(;this.onDispose.length>0;){const e=this.onDispose.pop();e&&e()}const e=a(this.inputElement,".dxbs-input-group");if(e){const t=e.querySelector(".dxbs-preloader-container");r.remove(t)}void 0!==l&&l.disposeMaskManager(this.managerId)}setValue(e,t,s){const i=new h(l.setValue(this.managerId,e,t));this.applyMaskInfo(i,!1,s)}updateMask(e,t){this.maskProperties=e;const s=new h(l.updateProperties(this.managerId,e.maskMode,e.editMask,e.placeholder,e.lcid,e.flags,e.valueString,e.valueType));this.applyMaskInfo(s,!1,t)}}u.maskLoadingPromise=null;class c extends p{constructor(e,t,s,i){super(e,t),this.customArrowsProcessing=s,this.customWheelProcessing=i}initialize(e){this.inputElement.value=e,this.initializeEvents(this)}onKeyDown(t){this.checkValidInsertion(t,this.customArrowsProcessing)&&this.checkValidInput()&&!e.AndroidMobilePlatform&&(t.preventDefault(),this.dotnetHelper.invokeMethodAsync("KeyDown",t.key,t.shiftKey,t.ctrlKey),"ArrowLeft"!==t.key&&"ArrowRight"!==t.key&&"Home"!==t.key&&"End"!==t.key||(this.suppressFocusEvents=!0,this.inputElement.blur(),this.inputElement.focus(),this.suppressFocusEvents=!1))}onKeyUp(t){if(e.AndroidMobilePlatform){let e=t.key;229===t.keyCode&&(e=this.inputElement.value.substring(this.inputElement.selectionStart-1,this.inputElement.selectionStart)),this.dotnetHelper.invokeMethodAsync("KeyDown",e,!1,!1)}else"ArrowUp"!==t.key&&"ArrowDown"!==t.key||this.customArrowsProcessing||(t.preventDefault(),this.dotnetHelper.invokeMethodAsync("KeyUp",t.key))}onClick(e){this.checkValidInput()&&this.dotnetHelper.invokeMethodAsync("SetSelection",this.inputElement.selectionStart,this.inputElement.selectionEnd)}onCut(e){this.checkValidInput()&&(e.preventDefault(),document.execCommand("copy"),this.dotnetHelper.invokeMethodAsync("Clear",this.inputElement.selectionStart,this.inputElement.selectionEnd))}onPaste(e){if(!this.checkValidInput())return;e.preventDefault();const t=e.clipboardData,s=null==t?void 0:t.getData("Text");this.dotnetHelper.invokeMethodAsync("Paste",s)}onDrop(e){e.preventDefault()}onFocusByTab(e){this.dotnetHelper.invokeMethodAsync("SetSelection",0,e)}onFocusOut(e){this.checkValidInput()&&!this.suppressFocusEvents&&(e.preventDefault(),this.dotnetHelper.invokeMethodAsync("OnFocusLost_LocalMask"))}onWheel(e,t){this.canHandleMouseWheel()&&(e.preventDefault(),this.dotnetHelper.invokeMethodAsync("OnMouseWheel",e.deltaY<0))}}const m=new Map;function k(e,t,s,i,n,o){return new Promise(((a,r)=>{let l=m.get(e);l||(l=new u(e,s,t,i),l.initializeMonoMasks(n,o).then((()=>{m.set(e,l),a()})).catch((()=>r())))}))}function E(e,t,s,i,n){let o=m.get(e);o||(o=new c(e,t,i,n),o.initialize(s),m.set(e,o))}function v(e,t,s,i){const n=m.get(e);n&&n.setValue(t,s,i)}function g(e,t,s){const i=m.get(t);i&&i.updateMask(e,s)}function y(e,t,s,i){e.value=t,document.activeElement===e&&e.setSelectionRange(s,i)}function M(e,t){const s=m.get(e);s&&s instanceof u&&s.blockSpinButtonFocusEvents(t,s)}function f(e){if(e=o(e)){t(e);m.get(e)&&m.delete(e)}return Promise.resolve("ok")}const w=Object.freeze({__proto__:null,initMonoMasks:k,initServerMasks:E,setValueToMonoMaskManager:v,updateRemoteMask:g,applyMaskParameters:y,blockFocusEventsForSpinButtons:M,dispose:f,default:{initMonoMasks:k,setValueToMonoMaskManager:v,initServerMasks:E,applyMaskParameters:y,updateRemoteMask:g,dispose:f}});export{r as P,M as b,w as d};
