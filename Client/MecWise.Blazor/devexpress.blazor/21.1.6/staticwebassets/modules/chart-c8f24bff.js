import{D as e}from"./dom-a06f5987.js";import{H as t,c as n,e as o,w as r}from"./dom-utils-69ea39c0.js";import{setupTooltip as i,hideTooltip as a}from"./tooltip-0507cc49.js";import{r as l,d as s}from"./disposable-35c3c450.js";import{p as c,t as u}from"./popup-utils-ba54a763.js";function d(t,n,o,r){if(!t)return;const i=g(n,o,r);if(!i)return;const a=t.querySelector(".dx-chart-legend-icon");if(a){const t=i.getColor();e.hasClassName(a,"dx-chart-def-icon")&&(a.style.backgroundColor=t),a.style.color=t}m(t,n,o,r,["mouseover","focusin"],(function(e){e.hover(n.option("legend.hoverMode"))})),m(t,n,o,r,["mouseout","focusout"],(function(e){e.clearHover()}))}function g(e,t,n){const o=e.getSeriesByPos(t);return n?o.getPoints().filter((function(e){return e.tag===n}))[0]:o}function m(e,t,n,o,r,i){r.forEach((function(r){const a=function(){const e=g(t,n,o);e&&i(e)};e.addEventListener(r,a),l(e,(()=>{e.removeEventListener(r,a)}))}))}let p;async function f(e,n,o){if(!n.panes||0===n.panes.filter((function(e){return"default"!==e.name})).length)return;p=new Array(n.panes.length);let r=0,i=0;function a(t){const a=y(e,t);if(a){i=a.offsetHeight+r;const e=function(e,t){return e._valueAxes.filter((function(e){return e.pane===t.name}))[0]}(n,t),l=function(e,t){return e._argumentAxes.filter((function(e){return e.pane===t.name}))[0]}(n,t),s=e._axisGridGroup.element;p.push({grid:s,paneLegendElement:a});const c=[e._axisGroup.element,s,l._axisGroup.element,l._axisElementsGroup.element,e._axisElementsGroup.element];if(c){!function(e,t,n){e.forEach((function(e){h(e._group.element.style,n),h(e._labelsGroup.element.style,n)})),t.forEach((e=>h(e.style,n)))}(n.series.filter((function(e){return e.pane===t.name})),c,o?-i:i)}r+=i}}await t((()=>{const t=e.querySelector(".dx-chart-legend-container");if(o){for(let e=n.panes.length-2;e>=0;e--)a(n.panes[e]);h(y(e,n.panes[n.panes.length-1]).style,0),t&&(t.style.marginTop="-"+i+"px",t.style.marginBottom="0px"),n.option("margin",{top:r})}else{for(let e=1;e<=n.panes.length-1;e++)a(n.panes[e]);h(y(e,n.panes[0]).style,0),t&&(t.style.marginBottom="-"+i+"px",t.style.marginTop="0px"),n.option("margin",{bottom:r})}})),await async function(e){const n=10;return t((()=>{p.forEach((t=>{const o=t.grid.getBoundingClientRect(),r=t.paneLegendElement.getBoundingClientRect();let i;i=e?o.bottom+n-r.top:o.top-n-r.bottom,h(t.paneLegendElement.style,i+c(t.paneLegendElement.style).top)}))}))}(o)}function h(e,t){n((function(){u(e,0,t)}))}function y(e,t){return e.querySelector(".dx-chart-legend[data-pane='"+t.name+"']")}class v{constructor(e,t){this.widget=t,this.chartElement=v.getChartElement(e)}static getChartElement(e){return e.querySelector(".dx-chart")}}const b=new Map;async function x(e,t,n){const o=await import("./devexpress-394524a9.js");return new Promise((function(r){try{const i=function(e,t,n,o){const r=n.series.map((e=>e.category))[0],i="pie"===r||"donut"===r?e.viz.dxPieChart:e.viz.dxChart;return function(e){e.type=r,o(new i(t,e))}}(o,v.getChartElement(e),t,r);w(e,t,n,i)}catch(e){window.console.error(e.name+":"+e.message)}}))}async function w(o,r,i,a){if(r.palette)a(E(o,r,i,r.palette));else{const l=["bg-primary","bg-success","bg-danger","bg-warning","bg-info","bg-secondary"],s=document.createElement("DIV");s.className="d-none position-absolute";for(let e=0;e<l.length;e++){const t=document.createElement("DIV");t.className=l[e],s.appendChild(t)}n((function(){document.body.appendChild(s),t((function(){const t=[];for(let n=0;n<s.childNodes.length;n++)t.push(e.getCurrentStyle(s.childNodes[n]).backgroundColor);n((function(){document.body.removeChild(s),a(E(o,r,i,t))}))}))}))}}function E(e,t,n,o){let l=!1;const s=window.getComputedStyle(document.body).getPropertyValue("color");const c={animation:t.animation,tooltip:t.tooltip,dataSource:t.dataSource,palette:o,rotated:t.rotated,resolveLabelOverlapping:t.labelOverlap,commonAxisSettings:{label:{overlappingBehavior:"rotate",rotationAngle:45,font:{color:s,opacity:.75}}},dataPrepareSettings:{sortingMethod:!1},commonSeriesSettings:{argumentField:"argument",valueField:"value",openValueField:"openValue",highValueField:"highValue",lowValueField:"lowValue",closeValueField:"closeValue",rangeValue1Field:"startValue",rangeValue2Field:"endValue",sizeField:"size",type:"bar"},adaptiveLayout:{width:0,height:0},seriesTemplate:{nameField:"seriesId",customizeSeries:function(e){return t.series.filter((function(t){return t.seriesId===e}))[0]}},customizeLabel:function(e){return e.data.pointLabel},customizePoint:function(e){return e.data.pointAppearance},legend:{visible:!1,hoverMode:(t.legend?t.legend.hoverMode:null)||"includepoints"},onDrawn:async function(n){l||(l=!0,function(e,t){var n;const o=e.querySelectorAll(".dx-chart-legend-item");for(let e=0;e<o.length;e++){const r=o[e];if(r){const e=+(null!==(n=r.getAttribute("data-series"))&&void 0!==n?n:""),o=r.getAttribute("data-point");d(r,t,e,o)}}}(e,n.component),t.legend&&!1!==t.legend.visible&&await f(e,n.component,"bottom"===t.legend.verticalAlignment),r(e,"dx-loading",!1))},valueAxis:t.valueAxis,panes:t.panes,argumentAxis:t.argumentAxis,pathModified:!1,zoomAndPan:t.zoomAndPan,scrollBar:t.scrollBar};if(c.argumentAxis?c.argumentAxis.aggregateByCategory=!0:c.argumentAxis={aggregateByCategory:!0},t.tooltip&&t.tooltip.enabled){i(c,t.tooltip,n);const o=e.querySelector(".dx-chart-legend");o&&o.addEventListener("mouseover",(function(){a(e,!0)}))}else c.tooltip={enabled:!1,forceEvents:!1};return c}function A(e){const t=b.get(e);return void 0===t?Promise.reject():t.widget}const C={init:function(e,t,n){return new Promise(((o,r)=>{const i=b.get(e);if(void 0===i||i.chartElement!==v.getChartElement(e)){const o=x(e,t,n);b.set(e,new v(e,o))}else i.widget.then((function(o){w(e,t,n,(function(e){e.animation={enabled:!1},o.option(e)}))})).catch(window.console.error);o()}))},dispose:function(e){if(!(e=o(e)))return;const t=e.querySelectorAll(".dx-chart-legend-item");for(let e=0;e<t.length;e++){const n=t[e];n&&s(n)}return function(e,t){e=o(e);const n=b.get(e);void 0!==n&&(n.chartElement=null,n.widget=null,t&&b.delete(e))}(e,!0)},onSeriesVisibleChanged:function(e,t,n,o){A(e).then((function(e){const r=g(e,t,n);o?r.show():r.hide()})).catch(window.console.error)},render:function(e){A(e).then((function(e){e.render()})).catch(window.console.error)}};export default C;
