import"./esm-chunk-d81494b9.js";import"./esm-chunk-a2731447.js";import{ensureElement as e,getParentByClassName as t}from"./esm-dom-utils-0e4190ff.js";import{a as n,d as o}from"./esm-chunk-9c16a801.js";import{d as a,r as s}from"./esm-chunk-f1e43abb.js";import{K as r}from"./esm-chunk-808bf349.js";function u(e,t){e&&(e.dataset.previousValue=t)}function i(u,i,d){u=e(u);const c=t(u,"dxbs-spin-edit");if(!u)return;a(c);const l=(f=i.decimalSeparator,m=i.needExponentialView,p=u,function(e){let t=p.dataset.selectionStartBeforePaste?p.value.trim():p.value,n=/^-?(\d)*$/;f&&(t=t.replace(/[.|,]/g,f),n=m?/^-?(\d+|[,.]\d+|\d+[,.]\d+|\d+[,.]|[,.])?([eE]?[+-]?(\d)*)?$/:/^-?(\d+|[,.]\d+|\d+[,.]\d+|\d+[,.]|[,.])?$/);let o=p.selectionStart,a=p.selectionEnd;n.test(t)?(t!==p.value&&(p.value=t),p.dataset.previousValue=t):(p.dataset.selectionStartBeforePaste?(o=p.dataset.selectionStartBeforePaste,a=p.dataset.selectionEndBeforePaste):(o--,a+=p.dataset.previousValue.length-t.length),p.value=p.dataset.previousValue),p.dataset.selectionStartBeforePaste&&(p.removeAttribute("data-selection-start-before-paste"),p.removeAttribute("data-selection-end-before-paste")),p.selectionStart=o,p.selectionEnd=a});var f,m,p;const v=function(e){return function(t){e.dataset.selectionStartBeforePaste=e.selectionStart,e.dataset.selectionEndBeforePaste=e.selectionEnd}}(u),k=function(e){if(function(e){return e.keyCode===r.Up||e.keyCode===r.Down}(e)){if(e.stopPropagation(),e.preventDefault(),e.repeat)return;d.invokeMethodAsync("OnKeyDown",e.keyCode===r.Up,u.value)}},h=function(e){return function(e,t,n,o){if(document.activeElement!==n||!function(e){return!e.disabled&&!e.readOnly}(n)||"true"!==t.dataset.mouseOver)return;return e.preventDefault(),o.invokeMethodAsync("OnMouseWheel",e.deltaY<0,n.value),!1}(e,c,u,d)},P=function(e){return function(e){e.dataset.mouseOver=!0}(c)},b=function(e){return function(e){e.dataset.mouseOver=!1}(c)};return n(u,"input",l),n(u,"paste",v),n(u,"keydown",k),n(document,"wheel",h),n(c,"mouseenter",P),n(c,"mouseleave",b),s(c,(function(){o(u,"input",l),o(u,"keydown",k),o(u,"paste",v),o(document,"wheel",h),o(c,"mouseenter",P),o(c,"mouseleave",b)})),Promise.resolve("ok")}function d(e,t){let n=document.activeElement;for(;null!==n&&n!==e;)n=n.parentElement;null===n&&t.invokeMethodAsync("FocusLost")}function c(t){if(t=e(t))return a(t),Promise.resolve("ok")}const l={init:i,dispose:c,setPreviousValue:u,checkFocusedState:d};export default l;export{d as checkFocusedState,c as dispose,i as init,u as setPreviousValue};
