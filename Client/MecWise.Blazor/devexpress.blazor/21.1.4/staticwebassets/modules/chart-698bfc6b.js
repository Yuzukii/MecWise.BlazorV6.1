import{D as e}from"./dom-a06f5987.js";import{G as t,c as n,e as o,v as r}from"./dom-utils-d8c2ed7a.js";import{setupTooltip as i,hideTooltip as a}from"./tooltip-71525015.js";import{p as l,t as s}from"./popup-utils-5ca88cd0.js";function c(t,n,o,r,i){if(!t)return;const a=u(n,o,r);if(!a)return;const l=t.querySelector(".dx-chart-legend-icon");if(l){const t=a.getColor();e.hasClassName(l,"dx-chart-def-icon")&&(l.style.backgroundColor=t),l.style.color=t}i||(d(t,n,o,r,["mouseover","focusin"],(function(e){e.hover(n.option("legend.hoverMode"))})),d(t,n,o,r,["mouseout","focusout"],(function(e){e.clearHover()})))}function u(e,t,n){const o=e.getSeriesByPos(t);return n?o.getPoints().filter((function(e){return e.tag===n}))[0]:o}function d(e,t,n,o,r,i){r.forEach((function(r){e.addEventListener(r,(function(){const e=u(t,n,o);e&&i(e)}))}))}let g;async function p(e,n,o){if(!n.panes||0===n.panes.filter((function(e){return"default"!==e.name})).length)return;g=new Array(n.panes.length);let r=0,i=0;function a(t){const a=h(e,t);if(a){i=a.offsetHeight+r;const e=function(e,t){return e._valueAxes.filter((function(e){return e.pane===t.name}))[0]}(n,t),l=e._axisGridGroup.element;g.push({grid:l,paneLegendElement:a});const s=[e._axisGroup.element,l,f(n,t)._axisGroup.element];if(s){!function(e,t,n){e.forEach((function(e){m(e._group.element.style,n),m(e._labelsGroup.element.style,n)})),t.forEach((e=>m(e.style,n)))}(n.series.filter((function(e){return e.pane===t.name})),s,o?-i:i)}r+=i}}await t((()=>{const t=e.querySelector(".dx-chart-legend-container");if(o){for(let e=n.panes.length-2;e>=0;e--)a(n.panes[e]);m(h(e,n.panes[n.panes.length-1]).style,0),t&&(t.style.marginTop="-"+i+"px",t.style.marginBottom="0px"),n.option("margin",{top:r})}else{for(let e=1;e<=n.panes.length-1;e++)a(n.panes[e]);m(h(e,n.panes[0]).style,0),t&&(t.style.marginBottom="-"+i+"px",t.style.marginTop="0px"),n.option("margin",{bottom:r})}})),await async function(e){const n=10;return t((()=>{g.forEach((t=>{const o=t.grid.getBoundingClientRect(),r=t.paneLegendElement.getBoundingClientRect();let i;i=e?o.bottom+n-r.top:o.top-n-r.bottom,m(t.paneLegendElement.style,i+l(t.paneLegendElement.style).top)}))}))}(o)}function m(e,t){n((function(){s(e,0,t)}))}function f(e,t){return e._argumentAxes.filter((function(e){return e.pane===t.name}))[0]}function h(e,t){return e.querySelector(".dx-chart-legend[data-pane='"+t.name+"']")}class y{constructor(e,t){this.widget=t,this.chartElement=y.getChartElement(e)}static getChartElement(e){return e.querySelector(".dx-chart")}}const v=new Map;async function w(e,t,n){const o=await import("./devexpress-394524a9.js");return new Promise((function(r){try{const i=function(e,t,n,o){const r=n.series.map((e=>e.category))[0],i="pie"===r||"donut"===r?e.viz.dxPieChart:e.viz.dxChart;return function(e){e.type=r,o(new i(t,e))}}(o,y.getChartElement(e),t,r);b(e,t,n,i)}catch(e){window.console.error(e.name+":"+e.message)}}))}async function b(o,r,i,a){if(r.palette)a(x(o,r,i,r.palette));else{const l=["bg-primary","bg-success","bg-danger","bg-warning","bg-info","bg-secondary"],s=document.createElement("DIV");s.className="d-none position-absolute";for(let e=0;e<l.length;e++){const t=document.createElement("DIV");t.className=l[e],s.appendChild(t)}n((function(){document.body.appendChild(s),t((function(){const t=[];for(let n=0;n<s.childNodes.length;n++)t.push(e.getCurrentStyle(s.childNodes[n]).backgroundColor);n((function(){document.body.removeChild(s),a(x(o,r,i,t))}))}))}))}}function x(e,t,n,o){let l=!1;const s=window.getComputedStyle(document.body).getPropertyValue("color");const u={animation:t.animation,tooltip:t.tooltip,dataSource:t.dataSource,palette:o,rotated:t.rotated,resolveLabelOverlapping:t.labelOverlap,commonAxisSettings:{label:{overlappingBehavior:"rotate",rotationAngle:45,font:{color:s,opacity:.75}}},dataPrepareSettings:{sortingMethod:!1},commonSeriesSettings:{argumentField:"argument",valueField:"value",openValueField:"openValue",highValueField:"highValue",lowValueField:"lowValue",closeValueField:"closeValue",rangeValue1Field:"startValue",rangeValue2Field:"endValue",sizeField:"size",type:"bar"},adaptiveLayout:{width:0,height:0},seriesTemplate:{nameField:"seriesId",customizeSeries:function(e){return t.series.filter((function(t){return t.seriesId===e}))[0]}},customizeLabel:function(e){return e.data.pointLabel},customizePoint:function(e){return e.data.pointAppearance},legend:{visible:!1,hoverMode:(t.legend?t.legend.hoverMode:null)||"includepoints"},onDrawn:async function(n){l||(l=!0,function(e,t){var n;const o=e.querySelectorAll(".dx-chart-legend-item");for(let e=0;e<o.length;e++){const r=o[e];if(r){const e=+(null!==(n=r.getAttribute("data-series"))&&void 0!==n?n:""),o=r.getAttribute("data-point");c(r,t,e,o,!0)}}}(e,n.component),t.legend&&!1!==t.legend.visible&&await p(e,n.component,"bottom"===t.legend.verticalAlignment),r(e,"dx-loading",!1))},valueAxis:t.valueAxis,panes:t.panes,argumentAxis:t.argumentAxis,pathModified:!0,zoomAndPan:t.zoomAndPan,scrollBar:t.scrollBar};if(u.argumentAxis?u.argumentAxis.aggregateByCategory=!0:u.argumentAxis={aggregateByCategory:!0},t.tooltip&&t.tooltip.enabled){i(u,t.tooltip,n);const o=e.querySelector(".dx-chart-legend");o&&o.addEventListener("mouseover",(function(){a(e,!0)}))}return u}function C(e){const t=v.get(e);return void 0===t?Promise.reject():t.widget}const E={init:function(e,t,n){return new Promise(((o,r)=>{const i=v.get(e);if(void 0===i||i.chartElement!==y.getChartElement(e)){const o=w(e,t,n);v.set(e,new y(e,o))}else i.widget.then((function(o){b(e,t,n,(function(e){e.animation={enabled:!1},o.option(e)}))})).catch(window.console.error);o()}))},dispose:function(e){if(e=o(e))return function(e,t){e=o(e);const n=v.get(e);void 0!==n&&(n.chartElement=null,n.widget=null,t&&v.delete(e))}(e,!0)},onSeriesLegendElementReceived:function(e,t,n,o){C(e).then((function(e){c(o,e,t,n,!1)})).catch(window.console.error)},onSeriesVisibleChanged:function(e,t,n,o){C(e).then((function(e){const r=u(e,t,n);o?r.show():r.hide()})).catch(window.console.error)},render:function(e){C(e).then((function(e){e.render()})).catch(window.console.error)}};export default E;
