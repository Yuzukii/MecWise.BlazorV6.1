import{u as i,n as t}from"./dom-utils-d8c2ed7a.js";class e{constructor(i,t){this.preloader=i,this.parent=t,this._initialPaddingRight=0,this._initialPaddingLeft=0,this._contentWidth=0,this._internalWidthChanging=!1,this._unsubscriber=()=>!1,this._onHide=new Array,this.preloaderElement=i,this._preloaderWidth=i.offsetWidth,this.parentElement=t}static get(i){return e.preloaderMap.get(i)}static create(i,t){let n=e.get(i);return n||(n=new e(i,t),e.preloaderMap.set(i,n)),n}static remove(i){const t=e.preloaderMap.get(i);t&&(t.hide(),e.preloaderMap.delete(i))}display(i){this.init(i),this.preloaderElement.style.top=(this.parentElement.offsetHeight-this.preloaderElement.offsetHeight)/2+"px",this.calculateHorizontalPosition(this.parentElement.clientWidth-this._initialPaddingLeft-this._initialPaddingRight),this._internalWidthChanging=!0,this._unsubscriber=this.subscribeOnParentWidthChange(),this.preloaderElement.classList.remove("dxbs-preloader-initial")}hide(){this.preloaderElement.onanimationend=()=>{this.preloaderElement.style.display="none",i(this._unsubscriber),this.parentElement.style.paddingRight=this._initialPaddingRight+"px",this._onHide.forEach((i=>{i()})),this._onHide=[]},this.preloaderElement.classList.add("dxbs-preloader-success")}registerOnHideAction(i){this._onHide.push(i)}changeInitialPaddingRight(i){this._initialPaddingRight=i}init(i){this._contentWidth=i;const t=getComputedStyle(this.parentElement);this._initialPaddingRight=parseFloat(t.paddingRight),this._initialPaddingLeft=parseFloat(t.paddingLeft)}subscribeOnParentWidthChange(){return t(this.parentElement,(i=>{this._internalWidthChanging?this._internalWidthChanging=!1:this.calculateHorizontalPosition(i)}))}calculateHorizontalPosition(i){const t=parseFloat(this.parentElement.style.paddingRight);if(0===i||t===this._initialPaddingRight&&i-this._preloaderWidth<0)return this.preloaderElement.style.visibility="hidden",void(t!==this._initialPaddingRight&&(this._internalWidthChanging=!0,this.parentElement.style.paddingRight=this._initialPaddingRight+"px"));if(this.preloaderElement.style.visibility="visible",i<this._preloaderWidth+this._contentWidth)this.preloaderElement.style.left="auto",this.preloaderElement.style.right=this._initialPaddingRight+"px",t!==this._initialPaddingRight+this._preloaderWidth&&(this.parentElement.style.paddingRight=this._initialPaddingRight+this._preloaderWidth+"px",this._internalWidthChanging=!0);else{this.preloaderElement.style.left="calc("+(this._contentWidth+this._initialPaddingLeft)+"px + "+(0===this._contentWidth?"0":"0.5")+"em)",t!==this._initialPaddingRight&&(this._internalWidthChanging=!0,this.parentElement.style.paddingRight=this._initialPaddingRight+"px")}}}e.preloaderMap=new Map;export{e as P};
